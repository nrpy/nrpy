#include "BHaH_defines.h"
/**
 * Evaluate the SEOBNRv5 coefficients.
 */
void SEOBNRv5_aligned_spin_coefficients(commondata_struct *restrict commondata) {

  const REAL q = commondata->mass_ratio;
  commondata->m1 = q / (1.0 + q);
  commondata->m2 = 1.0 / (1.0 + q);
  const REAL m1 = commondata->m1;
  const REAL m2 = commondata->m2;
  const REAL chi1 = commondata->chi1;
  const REAL chi2 = commondata->chi2;
  commondata->dT = commondata->dt / commondata->total_mass / 4.925490947641266978197229498498379006e-6;
  const REAL tmp0 = m1 + m2;
  const REAL tmp2 = m1 * m2;
  const REAL tmp5 = ((m1) * (m1));
  const REAL tmp6 = ((m2) * (m2));
  const REAL tmp10 = ((m1) * (m1) * (m1));
  const REAL tmp11 = ((m2) * (m2) * (m2));
  const REAL tmp40 = chi1 - chi2;
  const REAL tmp46 = m2 / m1;
  const REAL tmp1 = (1.0 / ((tmp0) * (tmp0)));
  const REAL tmp4 = (1.0 / ((tmp0) * (tmp0) * (tmp0) * (tmp0)));
  const REAL tmp7 = tmp5 * tmp6;
  const REAL tmp9 = pow(tmp0, -6);
  const REAL tmp13 = pow(tmp0, -8);
  const REAL tmp17 = chi1 * m1 + chi2 * m2;
  const REAL tmp18 = chi1 * m1 - chi2 * m2;
  const REAL tmp42 = tmp5 + tmp6;
  const REAL tmp3 = tmp1 * tmp2;
  const REAL tmp8 = tmp4 * tmp7;
  const REAL tmp12 = tmp10 * tmp11 * tmp9;
  const REAL tmp14 = ((m1) * (m1) * (m1) * (m1)) * ((m2) * (m2) * (m2) * (m2)) * tmp13;
  const REAL tmp20 = ((tmp17) * (tmp17) * (tmp17)) * tmp9;
  const REAL tmp21 = ((tmp17) * (tmp17));
  const REAL tmp24 = ((tmp18) * (tmp18));
  const REAL tmp28 = tmp17 * tmp9;
  const REAL tmp30 = tmp18 * tmp7 * tmp9;
  const REAL tmp44 = chi1 * tmp5 + chi2 * tmp6;
  const REAL tmp47 = (chi1 + chi2 * tmp6 / tmp5) / ((tmp46 + 1) * (tmp46 + 1));
  const REAL tmp23 = tmp17 * tmp2 * tmp4;
  const REAL tmp27 = tmp2 * tmp24 * tmp9;
  const REAL tmp31 = tmp17 * tmp18 * tmp4;
  const REAL tmp34 = pow(tmp3, (100513217.0 / 10000000.0) * tmp3 - 1.0 / 5.0);
  const REAL tmp35 =
      -69456549.0 / 1250.0 * tmp10 * tmp11 * tmp9 + (21137477.0 / 20000.0) * tmp3 + (979317619.0 / 100000.0) * tmp8 + 2981159.0 / 50000.0;
  const REAL tmp41 = tmp40 * sqrt(1 - 4 * tmp3);
  const REAL tmp45 = tmp44 / tmp42;
  const REAL tmp48 = tmp3 * (chi1 + chi2);
  const REAL tmp53 = (1.0 / 2.0) * tmp47;
  const REAL tmp26 = tmp2 * tmp21 * tmp9;
  const REAL tmp32 = tmp18 * tmp21 * tmp9;
  const REAL tmp36 = -tmp34 * tmp35;
  const REAL tmp49 = tmp47 + (237023.0 / 500000.0) * tmp48;
  const REAL tmp38 =
      ((43927533102497.0 / 2500000000000.0) * tmp1 * tmp17 + (142203101910927.0 / 10000000000000.0) * tmp1 * tmp18 -
       678913884987037.0 / 100000000000000.0 * tmp13 * ((tmp17) * (tmp17) * (tmp17) * (tmp17)) +
       (179569824846781.0 / 1000000000000.0) * tmp18 * tmp2 * tmp28 - 901929138487509.0 / 10000000000000.0 * tmp18 * tmp2 * tmp4 +
       (539962303470497.0 / 100000000000000.0) * tmp20 + (498016443361381.0 / 10000000000000.0) * tmp21 * tmp4 -
       141253181790353.0 / 1000000000000.0 * tmp23 + (839238879807543.0 / 100000000000000.0) * tmp24 * tmp28 +
       (361705291738517.0 / 50000000000000.0) * tmp24 * tmp4 - 66112475388613.0 / 500000000000.0 * tmp26 -
       169056858928167.0 / 10000000000000.0 * tmp27 + (384201018794943.0 / 1000000000000.0) * tmp28 * tmp7 +
       (144253395844761.0 / 1000000000000.0) * tmp30 - 16242546139071.0 / 400000000000.0 * tmp31 + (9983993723749.0 / 1562500000000.0) * tmp32) /
      pow(tmp3, 1.0 / 5.0);
  const REAL tmp50 = ((tmp49) * (tmp49));
  const REAL tmp51 = ((tmp49) * (tmp49) * (tmp49));
  const REAL tmp52 = ((tmp49) * (tmp49) * (tmp49) * (tmp49));
  const REAL tmp55 = (237023.0 / 1000000.0) * tmp48 - 1.0 / 2.0 * fabs(tmp49 - 1);
  const REAL tmp39 = tmp36 + tmp38;
  const REAL tmp56 = tmp53 + tmp55 + 1.0 / 2.0;
  const REAL tmp72 = (1.0 / 2.0) * fabs(tmp34 * tmp35 - tmp38);
  const REAL tmp73 = (1.0 / 2.0) * tmp36 + (1.0 / 2.0) * tmp38;
  const REAL tmp59 = cbrt(1 - ((tmp56) * (tmp56))) * (cbrt(-tmp53 - tmp55 + 1.0 / 2.0) + cbrt(tmp53 + tmp55 + 3.0 / 2.0));
  const REAL tmp60 = sqrt(3 * ((tmp56) * (tmp56)) + ((tmp59 + 1) * (tmp59 + 1)));
  const REAL tmp61 = 3 * tmp60 - 3 * sqrt((2 - tmp59) * (tmp59 + 2 * tmp60 + 4)) * (((tmp56) > 0) - ((tmp56) < 0));
  const REAL tmp62 = fabs(tmp3 * (-324251.0 / 500.0 * tmp12 * tmp49 - 697177.0 / 1000.0 * tmp12 * tmp50 + (376869.0 / 500.0) * tmp12 * tmp51 +
                                  (116689.0 / 100.0) * tmp12 * tmp52 + (223911.0 / 1000.0) * tmp12 - 91167.0 / 1250.0 * tmp3 * tmp49 -
                                  215009.0 / 2500.0 * tmp3 * tmp50 + (937371.0 / 10000.0) * tmp3 * tmp51 + (8039.0 / 40.0) * tmp3 * tmp52 +
                                  (175639.0 / 5000.0) * tmp3 + (339221.0 / 100000.0) * tmp47 + (80403179083.0 / 50000000000.0) * tmp48 +
                                  (48398.0 / 125.0) * tmp49 * tmp8 + (447009.0 / 1000.0) * tmp50 * tmp8 + (89773.0 / 20000.0) * tmp50 -
                                  467383.0 / 1000.0 * tmp51 * tmp8 - 577101.0 / 100000.0 * tmp51 - 884339.0 / 1000.0 * tmp52 * tmp8 -
                                  130459.0 / 10000.0 * tmp52 - 73411.0 / 500.0 * tmp8 - 597723.0 / 100000.0) -
                          2 * tmp47 * (sqrt(1 - 2 / (tmp61 + 9)) - 1) + (2.0 / 9.0) * sqrt(3) * (2 * sqrt(tmp61 + 7) + 1)) /
                     (m1 / m2 + tmp46 + 2);
  const REAL tmp64 = (1.0 / 2.0) * fabs(tmp47 + tmp62 - 1);
  const REAL tmp66 = (1.0 / 2.0) * tmp62 - tmp64;
  const REAL tmp67 = tmp53 + tmp66 + 1.0 / 2.0;
  const REAL tmp69 = cbrt(1 - ((tmp67) * (tmp67))) * (cbrt(tmp53 + tmp66 + 3.0 / 2.0) + cbrt(-tmp53 - 1.0 / 2.0 * tmp62 + tmp64 + 1.0 / 2.0));
  const REAL tmp70 = sqrt(3 * ((tmp67) * (tmp67)) + ((tmp69 + 1) * (tmp69 + 1)));
  const REAL tmp71 = sqrt((2 - tmp69) * (tmp69 + 2 * tmp70 + 4)) * (((tmp67) > 0) - ((tmp67) < 0));
  commondata->a6 =
      -8450957.0 / 50.0 * tmp12 + (164761631.0 / 500.0) * tmp14 - 151096691.0 / 50000.0 * tmp3 + (167072197.0 / 5000.0) * tmp8 + 3343023.0 / 80000.0;
  commondata->dSO =
      (362767393298729.0 / 1000000000000.0) * m1 * m2 * tmp17 * tmp18 * tmp9 + (472431937787377.0 / 1000000000000.0) * m1 * m2 * tmp18 * tmp4 +
      (248149587560829.0 / 5000000000000.0) * tmp1 * tmp17 - 9935579264329.0 / 250000000000.0 * tmp1 * tmp18 +
      (19141849252219.0 / 40000000000.0) * tmp10 * tmp11 * tmp9 - 771251231383957.0 / 100000000000000.0 * ((tmp18) * (tmp18) * (tmp18)) * tmp9 -
      379229051788729.0 / 50000000000000.0 * tmp20 + (181783435552183.0 / 10000000000000.0) * tmp21 * tmp4 -
      905790079104259.0 / 10000000000000.0 * tmp23 - 34458935958803.0 / 2000000000000.0 * tmp24 * tmp28 +
      (139092333564509.0 / 2000000000000.0) * tmp24 * tmp4 - 106900282419711.0 / 2500000000000.0 * tmp26 - 29803797922287.0 / 125000000000.0 * tmp27 -
      201905934468847.0 / 1000000000000.0 * tmp28 * tmp7 - 44333707942019.0 / 250000000000.0 * tmp3 - 7841677871207.0 / 6250000000.0 * tmp30 -
      429018169005137.0 / 5000000000000.0 * tmp31 - 21045087798063.0 / 2000000000000.0 * tmp32 +
      (135904353989799.0 / 200000000000.0) * tmp4 * tmp5 * tmp6 - 376897780220529.0 / 10000000000000.0;
  commondata->Delta_t = tmp39;
  commondata->M_f = -559265167715539.0 / 50000000000000000.0 * tmp12 * ((tmp40) * (tmp40)) +
                    (1978238971523653.0 / 100000000000000000.0) * tmp3 * tmp41 * tmp45 * (1 - 122916937253953.0 / 25000000000000.0 * tmp3) +
                    (9803730445895877.0 / 100000000000000000.0) * tmp41 * tmp8 * (1 - 16141856688969567.0 / 5000000000000000.0 * tmp3) + 1 -
                    (-21166890941101.0 / 25000000000000.0 * tmp12 + (3145145224278187.0 / 1000000000000000.0) * tmp14 +
                     tmp3 * (1 - 2.0 / 3.0 * M_SQRT2) + (2804952067656687.0 / 5000000000000000.0) * tmp8) *
                        (tmp45 * (-227746231604769722826172935715177.0 / 200000000000000000000000000000000.0 * tmp3 +
                                  (6863430805137136752764300064894009.0 / 1250000000000000000000000000000000.0) * tmp4 * tmp5 * tmp6 -
                                  327109729544581377763747084001823.0 / 2500000000000000000000000000000000.0) +
                         1 +
                         ((tmp44) * (tmp44)) *
                             ((13604174376143420596066298767786307.0 / 6250000000000000000000000000000000.0) * tmp8 -
                              17762802148331424453066298767786307.0 / 100000000000000000000000000000000000.0) /
                             ((tmp42) * (tmp42)) +
                         ((tmp44) * (tmp44) * (tmp44)) *
                             ((386929573968437724035279145633.0 / 78125000000000000000000000000.0) * m1 * m2 * tmp1 -
                              4894408200184628525726278320417.0 / 488281250000000000000000000000.0 * tmp8 -
                              617206215370269546894462540051.0 / 976562500000000000000000000000.0) /
                             ((tmp42) * (tmp42) * (tmp42))) /
                        (-tmp45 * (-1148813183326099483389242224810907.0 / 3125000000000000000000000000000000.0 * tmp3 -
                                   834876433188293891604740723453181.0 / 195312500000000000000000000000000.0 * tmp8 +
                                   12399344183710758759808205118623631.0 / 12500000000000000000000000000000000.0) +
                         1);
  commondata->a_f = tmp47 + tmp62;
  commondata->r_ISCO = tmp70 - tmp71 + 3;
  commondata->r_stop = (tmp72 + tmp73) * ((49.0 / 50.0) * tmp70 - 49.0 / 50.0 * tmp71 + 147.0 / 50.0) / (TINYDOUBLE + tmp39) -
                       (-tmp72 + tmp73) / (-TINYDOUBLE + tmp39);

  const REAL afinallist[107] = {
      -0.9996, -0.9995, -0.9994, -0.9992, -0.999, -0.9989, -0.9988, -0.9987, -0.9986, -0.9985, -0.998, -0.9975, -0.997, -0.996, -0.995, -0.994,
      -0.992,  -0.99,   -0.988,  -0.986,  -0.984, -0.982,  -0.98,   -0.975,  -0.97,   -0.96,   -0.95,  -0.94,   -0.92,  -0.9,   -0.88,  -0.86,
      -0.84,   -0.82,   -0.8,    -0.78,   -0.76,  -0.74,   -0.72,   -0.7,    -0.65,   -0.6,    -0.55,  -0.5,    -0.45,  -0.4,   -0.35,  -0.3,
      -0.25,   -0.2,    -0.15,   -0.1,    -0.05,  0.,      0.05,    0.1,     0.15,    0.2,     0.25,   0.3,     0.35,   0.4,    0.45,   0.5,
      0.55,    0.6,     0.65,    0.7,     0.72,   0.74,    0.76,    0.78,    0.8,     0.82,    0.84,   0.86,    0.88,   0.9,    0.92,   0.94,
      0.95,    0.96,    0.97,    0.975,   0.98,   0.982,   0.984,   0.986,   0.988,   0.99,    0.992,  0.994,   0.995,  0.996,  0.997,  0.9975,
      0.998,   0.9985,  0.9986,  0.9987,  0.9988, 0.9989,  0.999,   0.9992,  0.9994,  0.9995,  0.9996};

  const REAL reomegaqnm22[107] = {
      0.2915755, 0.291581,  0.2915866, 0.2915976, 0.2916086, 0.2916142, 0.2916197, 0.2916252, 0.2916307, 0.2916362, 0.2916638, 0.2916915,
      0.2917191, 0.2917744, 0.2918297, 0.291885,  0.2919958, 0.2921067, 0.2922178, 0.2923289, 0.2924403, 0.2925517, 0.2926633, 0.292943,
      0.2932235, 0.2937871, 0.2943542, 0.2949249, 0.2960772, 0.2972442, 0.2984264, 0.299624,  0.3008375, 0.3020672, 0.3033134, 0.3045767,
      0.3058573, 0.3071558, 0.3084726, 0.3098081, 0.3132321, 0.316784,  0.3204726, 0.3243073, 0.3282986, 0.3324579, 0.336798,  0.3413329,
      0.3460786, 0.3510526, 0.3562748, 0.3617677, 0.3675569, 0.3736717, 0.3801456, 0.3870175, 0.394333,  0.4021453, 0.4105179, 0.4195267,
      0.4292637, 0.4398419, 0.4514022, 0.464123,  0.4782352, 0.4940448, 0.5119692, 0.5326002, 0.5417937, 0.5516303, 0.5622007, 0.5736164,
      0.586017,  0.5995803, 0.6145391, 0.631206,  0.6500179, 0.6716143, 0.6969947, 0.7278753, 0.74632,   0.7676741, 0.7932082, 0.8082349,
      0.8254294, 0.8331,    0.8413426, 0.8502722, 0.8600456, 0.8708927, 0.8830905, 0.8969183, 0.9045305, 0.912655,  0.9213264, 0.9258781,
      0.9305797, 0.9354355, 0.9364255, 0.937422,  0.9384248, 0.9394341, 0.9404498, 0.9425009, 0.9445784, 0.9456271, 0.9466825};

  const REAL imomegaqnm22[107] = {
      0.0880269, 0.0880272, 0.0880274, 0.088028,  0.0880285, 0.0880288, 0.088029,  0.0880293, 0.0880296, 0.0880298, 0.0880311, 0.0880325,
      0.0880338, 0.0880364, 0.0880391, 0.0880417, 0.088047,  0.0880523, 0.0880575, 0.0880628, 0.088068,  0.0880733, 0.0880785, 0.0880915,
      0.0881045, 0.0881304, 0.088156,  0.0881813, 0.0882315, 0.0882807, 0.0883289, 0.0883763, 0.0884226, 0.0884679, 0.0885122, 0.0885555,
      0.0885976, 0.0886386, 0.0886785, 0.0887172, 0.0888085, 0.0888917, 0.0889663, 0.0890315, 0.0890868, 0.0891313, 0.0891643, 0.0891846,
      0.0891911, 0.0891825, 0.0891574, 0.0891138, 0.0890496, 0.0889623, 0.0888489, 0.0887057, 0.0885283, 0.0883112, 0.0880477, 0.0877293,
      0.0873453, 0.086882,  0.0863212, 0.0856388, 0.0848021, 0.0837652, 0.0824618, 0.0807929, 0.0799908, 0.0790927, 0.0780817, 0.0769364,
      0.0756296, 0.0741258, 0.072378,  0.0703215, 0.0678642, 0.0648692, 0.0611186, 0.0562313, 0.053149,  0.0494336, 0.0447904, 0.0419586,
      0.0386302, 0.0371155, 0.0354677, 0.033659,  0.0316517, 0.0293904, 0.0268082, 0.0238377, 0.0221857, 0.0204114, 0.0185063, 0.0175021,
      0.016462,  0.015385,  0.0151651, 0.0149437, 0.0147207, 0.0144962, 0.0142701, 0.0138132, 0.0133501, 0.0131161, 0.0128806};

  gsl_spline *spline = gsl_spline_alloc(gsl_interp_cspline, 107);
  gsl_interp_accel *acc = gsl_interp_accel_alloc();

  gsl_spline_init(spline, afinallist, reomegaqnm22, 107);
  commondata->omega_qnm = gsl_spline_eval(spline, commondata->a_f, acc) / commondata->M_f;

  gsl_spline_init(spline, afinallist, imomegaqnm22, 107);
  gsl_interp_accel_reset(acc);
  commondata->tau_qnm = 1. / (gsl_spline_eval(spline, commondata->a_f, acc) / commondata->M_f);

  gsl_spline_free(spline);
  gsl_interp_accel_free(acc);
} // END FUNCTION SEOBNRv5_aligned_spin_coefficients
